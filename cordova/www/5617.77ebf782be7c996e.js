"use strict";(self.webpackChunkpetterinary=self.webpackChunkpetterinary||[]).push([[5617],{5617:(I,p,c)=>{c.r(p),c.d(p,{UvLiveTrackingPageModule:()=>U});var d=c(6814),m=c(95),s=c(5958),f=c(5514),t=c(5879),u=c(5861),M=c(7650);let h=(()=>{class o{constructor(n){this.afs=n,this.docRef=this.afs.doc("liveTracking/7bZdz2lWAIRKOG1Q9eAb")}getLocation(){return this.docRef.valueChanges()}updateSourceLocation(n){var e=this;return(0,u.Z)(function*(){try{const i={sourceLat:n.lat,sourceLng:n.lng};return yield e.docRef.update(i),!0}catch(i){throw i}})()}static#n=this.\u0275fac=function(e){return new(e||o)(t.LFG(M.ST))};static#t=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var _=c(8583);let O=(()=>{class o{constructor(){}loadGoogleMaps(){const n=window,e=n.google;return e&&e.maps?Promise.resolve(e.maps):new Promise((i,a)=>{const r=document.createElement("script");r.src="https://maps.googleapis.com/maps/api/js?key="+_.N.googleMapsApiKey+"&callback=Function.prototype",r.async=!0,r.defer=!0,document.body.appendChild(r),r.onload=()=>{const g=n.google;g&&g.maps?i(g.maps):a("Google Map SDK is not Available")}})}static#n=this.\u0275fac=function(e){return new(e||o)};static#t=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var C=c(8662);let v=(()=>{class o{constructor(n){this.geolocation=n}getCurrentPosition(){var n=this;return(0,u.Z)(function*(){const e=yield n.geolocation.getCurrentPosition();return{lat:e.coords.latitude,lng:e.coords.longitude}})()}watchPosition(n){return this.geolocation.watchPosition().subscribe(i=>{i.coords?n({lat:i.coords.latitude,lng:i.coords.longitude}):console.error("Error getting position: ",i)})}static#n=this.\u0275fac=function(e){return new(e||o)(t.LFG(C.b))};static#t=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const y=["map"];let k=(()=>{class o{constructor(n,e,i,a){this.tracker=n,this.maps=e,this.renderer=i,this.geolocationService=a,this.updateDistanceAndDuration=new t.vpe,this.source={},this.dest={}}ngOnInit(){this.getLatLng()}getLatLng(){this.trackSub=this.tracker.getLocation().subscribe({next:n=>{this.source={lat:n.sourceLat,lng:n.sourceLng},this.dest?.lat?this.changeMarkerPosition(this.source):(this.dest={lat:n.destLat,lng:n.destLng},this.loadMap())}}),this.geolocationSub=this.geolocationService.watchPosition(n=>{console.log(n),this.tracker.updateSourceLocation(n)})}changeMarkerPosition(n){const e={lat:n.lat,lng:n.lng};this.source_marker.setPosition(e),this.map.panTo(e),this.drawRoute()}loadMap(){var n=this;return(0,u.Z)(function*(){try{let e=yield n.maps.loadGoogleMaps();const i=n.mapElementRef.nativeElement;n.map=new e.Map(i,{center:{lat:n.source.lat,lng:n.source.lng},disableDefaultUI:!0,zoom:13}),n.directionsService=new e.DirectionsService,n.directionsDisplay=new e.DirectionsRenderer;const a="assets/icon/loc-red.png",r="assets/icon/loc-gold.png",g=new e.LatLng(n.source.lat,n.source.lng),P=new e.LatLng(n.dest.lat,n.dest.lng),Z={url:a,scaledSize:new e.Size(40,40),origin:new e.Point(0,0),anchor:new e.Point(10,10)},S={url:r,scaledSize:new e.Size(40,40),origin:new e.Point(0,0),anchor:new e.Point(10,10)};n.source_marker=new e.Marker({map:n.map,position:g,animation:e.Animation.DROP,icon:Z}),n.destination_marker=new e.Marker({map:n.map,position:P,animation:e.Animation.DROP,icon:S}),n.source_marker.setMap(n.map),n.destination_marker.setMap(n.map),n.directionsDisplay.setMap(n.map),n.directionsDisplay.setOptions({polylineOptions:{strokeWeight:4,strokeOpacity:1,strokeColor:"black"},suppressMarkers:!0}),yield n.drawRoute(),n.map.setCenter(P),n.renderer.addClass(i,"visible")}catch(e){console.log(e)}})()}drawRoute(){this.directionsService.route({origin:this.source,destination:this.dest,travelMode:"DRIVING",provideRouteAlternatives:!0},(n,e)=>{if("OK"===e){this.directionsDisplay.setDirections(n);const i=n.routes[0].legs[0];this.updateDistanceAndDuration.emit({distance:i.distance.text,duration:i.duration.text})}else console.log(e)})}ngOnDestroy(){this.trackSub&&this.trackSub.unsubscribe(),this.geolocationSub&&this.geolocationSub.unsubscribe()}static#n=this.\u0275fac=function(e){return new(e||o)(t.Y36(h),t.Y36(O),t.Y36(t.Qsj),t.Y36(v))};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-map"]],viewQuery:function(e,i){if(1&e&&t.Gf(y,7),2&e){let a;t.iGM(a=t.CRH())&&(i.mapElementRef=a.first)}},outputs:{updateDistanceAndDuration:"updateDistanceAndDuration"},decls:2,vars:0,consts:[[1,"map"],["map",""]],template:function(e,i){1&e&&t._UZ(0,"div",0,1)},styles:[".map[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;background-color:transparent;opacity:0;transition:opacity .15s ease-in}.map.visible[_ngcontent-%COMP%]{opacity:1}"]})}return o})();function w(o,l){1&o&&(t.ynx(0),t._UZ(1,"img",17),t.BQk())}function b(o,l){1&o&&t._UZ(0,"img",18)}function D(o,l){if(1&o&&(t.ynx(0),t.TgZ(1,"ion-card")(2,"div",7)(3,"div",8),t.YNc(4,w,2,0,"ng-container",9),t.YNc(5,b,1,0,"ng-template",null,10,t.W1O),t.qZA(),t.TgZ(7,"div",11)(8,"div",12)(9,"h1"),t._uU(10),t.qZA(),t.TgZ(11,"ion-badge",13)(12,"p"),t._uU(13,"User Visit"),t.qZA()(),t.TgZ(14,"ion-buttons",14)(15,"ion-button"),t._UZ(16,"ion-icon",15),t.qZA()()(),t.TgZ(17,"div",16)(18,"span")(19,"strong"),t._uU(20),t.qZA()(),t.TgZ(21,"span")(22,"strong"),t._uU(23),t.qZA()()()()()(),t.BQk()),2&o){const n=l.$implicit,e=t.MAs(6);t.xp6(4),t.Q6J("ngIf","Laki-laki"===n.jenisKelamin)("ngIfElse",e),t.xp6(6),t.Oqu(n.nama),t.xp6(10),t.Oqu(n.dummyJarak),t.xp6(3),t.Oqu(n.dummyDuration)}}function x(o,l){if(1&o&&(t.ynx(0),t.YNc(1,D,24,5,"ng-container",6),t.BQk()),2&o){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.dataDokter)}}const L=[{path:"",component:(()=>{class o{constructor(n){this.tracker=n,this.dataDokter=[{idVet:4,koordinatUser:"w",koordinatDokter:"w",nama:"Drh. Joni",dummyJarak:"",dummyDuration:"",jenisKelamin:"Laki-laki"}]}updateDistanceAndDuration(n,e){this.dataDokter[0].dummyJarak=n,this.dataDokter[0].dummyDuration=e}ngOnInit(){}static#n=this.\u0275fac=function(e){return new(e||o)(t.Y36(h))};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-uv-live-tracking"]],decls:6,vars:2,consts:[[1,"full-screen-content",3,"fullscreen"],[1,"contents"],[1,"map-section"],[3,"updateDistanceAndDuration"],[1,"info-container"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"container"],[1,"docter-img"],[4,"ngIf","ngIfElse"],["female",""],[1,"testo"],[1,"content-container"],[1,"badge-yellow"],["slot","end"],["name","location"],[1,"distance"],["src","assets/icon/dokter-male.png",1,"doc-prof"],["src","assets/icon/dokter-female.png",1,"doc-prof"]],template:function(e,i){1&e&&(t.TgZ(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"app-map",3),t.NdJ("updateDistanceAndDuration",function(r){return i.updateDistanceAndDuration(r.distance,r.duration)}),t.qZA(),t.TgZ(4,"div",4),t.YNc(5,x,2,1,"ng-container",5),t.qZA()()()()),2&e&&(t.Q6J("fullscreen",!0),t.xp6(5),t.Q6J("ngIf",i.dataDokter))},dependencies:[d.sg,d.O5,k,s.yp,s.YG,s.Sm,s.PM,s.W2,s.gu],styles:["app-back-button[_ngcontent-%COMP%]{position:absolute;width:100%;--ion-background-color: transparent;background-color:transparent}app-back-button[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{opacity:.5}  .uv-livetrack-bb h1{opacity:.5}ion-list[_ngcontent-%COMP%]{background:transparent}ion-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1rem}.info-container[_ngcontent-%COMP%]{position:fixed;top:78.5%;left:50%;transform:translate(-50%,-50%);z-index:1;width:44vh;min-width:35vw}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .docter-img[_ngcontent-%COMP%]{padding:1vh;background-color:var(--ion-color-primary);border-radius:100%;margin-right:10px}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .docter-img[_ngcontent-%COMP%]   img.doc-prof[_ngcontent-%COMP%]{min-width:50px;width:50px}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]{color:#000;font-size:14px;word-wrap:break-word;text-overflow:ellipsis}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:2px 0;font-size:16px;font-weight:600}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   ion-badge.badge-yellow[_ngcontent-%COMP%]{background:#ffe600}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   ion-badge.badge-yellow[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:400;color:#000}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   ion-badge.badge-blue[_ngcontent-%COMP%]{background:#00ffff}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   ion-badge.badge-blue[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:400;color:#000}.info-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .distance[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}@media (orientation: landscape){.info-container[_ngcontent-%COMP%]{min-width:0;top:50%;width:auto;min-width:120px;max-width:200px;left:90%}.container[_ngcontent-%COMP%]{flex-direction:column}.container[_ngcontent-%COMP%]   .docter-img[_ngcontent-%COMP%]{margin-right:0!important}.container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;width:100%}.container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .distance[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;line-break:anywhere;justify-content:center}.container[_ngcontent-%COMP%]   .testo[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center}}"]})}return o})()}];let T=(()=>{class o{static#n=this.\u0275fac=function(e){return new(e||o)};static#t=this.\u0275mod=t.oAB({type:o});static#e=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(L),f.Bz]})}return o})();var A=c(8339);let U=(()=>{class o{static#n=this.\u0275fac=function(e){return new(e||o)};static#t=this.\u0275mod=t.oAB({type:o});static#e=this.\u0275inj=t.cJS({imports:[d.ez,m.u5,A.N,m.UX,s.Pc,T]})}return o})()}}]);